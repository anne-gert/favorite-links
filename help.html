<!DOCTYPE html>
<html>

<head>

<!-- This page may contain UTF-8 encoded text. -->
<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">

<title>Favorites and ToDo - Help</title>

<style>
/* CSS styles {{{ */

/****************************************************************************
 * Global definitions
 ****************************************************************************/

/* Color palette - dark theme */
.dark-theme {
	--foreground: #DDDDDD;
	--background: #2E323B;
	--accent-color: #50A0EE;
	--block-foreground: #000000;
	--block-background: #C9CDD0;
	--block-border: #EEEEEE;
	--selection-foreground: #000000;
	--selection-background: #DDDDFF;
	--code-foreground: var(--foreground);
	--code-background: #282828;
	--link-color: #6666FF;
	--disabled-color: #888888;
	--error-foreground: #FF6600;
	--error-background: #FFD8C0;
	--error-border: var(--error-foreground);
}

/* Color palette - light theme */
.light-theme {
	--foreground: #444444;
	--background: #E8F0F8;
	--accent-color: #4444EE;
	--block-foreground: #222222;
	--block-background: #D9DDE0;
	--block-border: #666666;
	--selection-foreground: #FFFFFF;
	--selection-background: #000099;
	--code-foreground: var(--foreground);
	--code-background: #C0C0C0;
	--link-color: #2222AA;
	--disabled-color: #888888;
	--error-foreground: #FFBB88;
	--error-background: #FFEEDD;
	--error-border: var(--error-foreground);
}

:root {
	/* Define variables that will be used on visible elements */
	--font-family: 'Segoe UI', 'Lucida Grande', Helvetica, sans-serif;
	--font-size: 100%
	/* Set default font and size */
	font-family: var(--font-family);
	font-size: 12pt;  /* absolute, so --font-size can be relative too */
}

body, input, textarea, button {
	font-family: var(--font-family);
	font-size: var(--font-size);
}

body {
	color: var(--accent-color); background: var(--background);
}
::selection {
	color: var(--selection-foreground); background: var(--selection-background);
}


/****************************************************************************
 * Shared styles for displaying text-blocks
 * These syles are shared between all pages
 ****************************************************************************/

.text-block {
	color: var(--foreground); background: var(--background);
}
.text-block h1, .text-block h2, .text-block h3, .text-block dt {
	color: var(--accent-color);
}
.text-block code, .text-block pre {
	color: var(--code-foreground); background: var(--code-background);
	padding: 0.1em 0.4em;
}
.text-block dt {
	display: inline;
}
.text-block a {
	color: var(--link-color);
	text-decoration: none;
}
.text-block a:hover {
	text-decoration: underline;
}

/* }}} */
</style>

</head>

<body class="text-block dark-theme">


<h1>Favorites and ToDo - Help</h1>


<!-- The following section is also included as a text block in
example-links.txt and DefaultLinks in favorites.html -->

<a name="description"></a>
<h2>Description</h2>

<p>
<a href="favorites.html">favorites.html</a> is a single page that can be
configured to show <u>links</u> and <u>todo lists</u>, organized in
<u>sections</u>, <u>blocks</u> and <u>items</u>. This configuration can be
downloaded via a URL and/or edited in the browser's LocalStorage (see below).
<br>
This page can be set as home page in the browser's settings and as the Tab
start page via an add-on like <a
href="https://addons.mozilla.org/en-US/firefox/addon/new-tab-override/">New Tab
Override</a>.
</p>

<p>
Note that the home page can be a local file (with <code>file:///...</code>
URL) or an internet address (with <code>http://...</code> or
<code>https://...</code> URL) and that the tab start page can only be an
internet address.
</p>


<a name="usage"></a>
<h2>Usage</h2>

<p>
The standard usage is to open the page favorites.html (or possibly set it as
your home page). Upon first opening, it shows a default example page.  This
page can be edited by going to the Settings (gears (&#x2699;) icon) and just
edit and save the textual configuration. Optionally, this configuration can be
maintained in a separate text file and copy-pasted into the Settings.
<br>
Since GitHub provides for a way to serve HTML pages directly, this can be used
to open and use favorites.html directly from <a
href="https://html-preview.github.io/?url=https://github.com/anne-gert/favorite-links/master/favorites.html">GitHub</a>.
Save the target of this link to your home page and you're set.
</p>

<p>
It is also possible to provide the configuration as a URL. This URL can be
provided in several ways:
<ul>
<li>In the configuration txt as <code>url:&lt;URL&gt;</code>.
<li>With the <code>links=url:&lt;URL&gt;</code> URL argument.
<li>With the <code>links-override=url:&lt;URL&gt;</code> URL argument.
</ul>
</p>

<p>
This is the order how the configuration is searched:
<ol>
<li><dt>links-override=</dt>: If <code>links-override=configuration</code> is
    provided, that content is used.
<li><dt>LocalStorage</dt>: If a configuration is stored in the browser's
    LocalStorage, that is used. Note that LocalStorage is per domain, so if
    the page is opened from a different domain, a different configuration
    might be present in the LocalStorage.
<li><dt>links=</dt>: If <code>links=configuration</code> is provided, that
    content is used.
<li>If any of the above was non-empty, that configuration is used. If that
    configuration is of the form <code>url:&lt;URL&gt;</code>, then
    &lt;URL&gt; will be downloaded to retrieve the configuration. This URL may
    be absolute or relative.
<li>If none of the above provided a non-empty configuration, a default
    configuration is used which includes examples and some explanation. This
    is the page that is initially shown if displayed without arguments.
</ol>
</p>


<a name="syntax"></a>
<h2>Configuration Syntax</h2>

<p>
The configuration consists primarily of a list of <a
href="help.html#link-syntax">Link Definitions</a>.  The Links form an
hierarchical structure, indicated by the line's indentation:
<ul>
<li><dt>Section</dt>: The first indentation level is the Section. Sections are
    separated by horizontal lines.
<li><dt>Block</dt>: The second indentation level are the blocks within a
    Section. Each Block is a visual area that can be collapsed and expanded.
<li><dt>Item</dt>: The third indentation level are the Items that populate
    the Blocks.
<li><dt>SubItem</dt>: The fourth and higher indentation levels are SubItems
    that are displayed under their respective parent Items
</ul>
Each link can be a hyperlink, have an icon and/or a checkbox.
</p>

<p>
In addition to Links, the configuration also supports comments, different
web-search functions and other directives, see <a
href="help.html#line-syntax">Line Syntax</a> for further details.
</p>

<!-- End of text to be included in text block -->


<a name="line-syntax"></a>
<h3>Line Syntax</h3>

<p>
Each line should be one of the following:
<ul>
  <li><dt>Empty lines</dt>: These are skipped.
  <li><dt>Comments</dt>: Lines that start with <code>//</code>, <code>;</code>
      or <code>#</code> are comments and skipped too.
  <li><dt>Folding</dt>: If a line ends with <code>{{{</code> or
      <code>}}}</code>, remove that.  These tags are used to facilitate folding
      in vim.
  <li><dt>Link Syntax</dt>: See below.
  <li><dt>Separator</dt>: This is a line containing a name of 3 or more dashes
      (<code>---</code>).  It is rendered as an <code>&lt;hr
      class="separator"&gt;</code> and it closes all indentation levels higher
      than its own, except when its indentation level is lower than block, in
      which case, it assumes the level of the item above it.
  <li><dt>Page Title</dt>: The line <code>!title name</code> specifies the page
      title to be displayed.
  <li><dt>Theme</dt>: The line <code>!theme name</code> specifies the CSS class
      name to use for the theme. Currently 'auto' (default), 'dark-theme' and
      'light-theme' are defined, but custom themes can be defined with a Style
      Block. See <a href="#themes">below</a> on use cases.
  <li><dt>Font Size</dt>: The line <code>!size font-size</code> specifies the
      base font-size to use. All CSS length quantities can be used, e.g.
      '10pt' or '120%'. This feature is experimental.
  <li><dt>Search Buttons</dt>: The line <code>!search identifier | label |
      tooltip | icon</code> defines a search button to be displayed next to the
      search box.  See <a href="#search-functions">below</a> for more details.
  <li><dt>Icon Definitions</dt>: The line <code>!icondef name
      replacement</code> defines an icon. If a link uses
      <code>icon=name</code>, it will be replaced by whatever is defined for
      name.  This also works with the special words <code>none</code>,
      <code>empty</code>, <code>html:x</code>, etc.  It is also allowed to
      write this with an <code>=</code> between name and replacement.
  <li><dt>Text Block</dt>: A text block is the lines of text between
      <code>!text</code> and <code>!endtext</code>, which each should appear
      on a line of their own. The text block will be rendered at that
      location. It can contain any HTML
  <li><dt>Style Block</dt>: A style block is the lines of text between
      <code>!style</code> and <code>!endstyle</code>, which should contain CSS
      definitions. See <a href="#themes">Themes</a> for an example.
  <li><dt>Script Block</dt>: A script block is the lines of text between
      <code>!script</code> and <code>!endscript</code>, which should contain
      JavaScript code that is executed at the beginning of the page. See <a
      href="#search-functions">Search Functions</a> for an example.
</ul>
</p>


<a name="link-syntax"></a>
<h3>Link Syntax</h3>

<p>
Each Link is specified on a single line as follows:
<ul>
  <li><dt>Indentation</dt>: The amount of indentation determines the nesting
      depth:
      <ul>
        <li>Tabs are replace by 8 spaces.
	<li>If the number of spaces is bigger than that of the previous line,
	    increase nesting depth by 1.
	<li>If the number of spaces is less than that of the previous line,
	    decrease the nesting depth to that of the most recent line that has
	    an indentation that is strictly less than this line.
      </ul>
  <li><dt>&amp;</dt> continuation: If the item starts with <code>&amp;</code>,
      this item is regarded as a continuation of a group of items that are
      displayed on a single line.
  <li><dt>Name</dt>: Arbitrary string of characters.
      <ul>
        <li>If no name is given, the URL is used.
	<li>If the name is <code>_</code> and an icon is provided, an empty
	    label is used.
      </ul>
  <li><dt>URL</dt>: A string of non-whitespace characters, beginning with
      <code>scheme:</code>.
      <ul>
        <li>If no URL is given, no hyperlink is created.
      </ul>
  <li><dt>icon=URL</dt>: URL of the icon to use.
      <ul>
	<li>If the value <code>default</code> is used or no icon is given, the
	    URL domain + <code>favicon.ico</code> is used.
	<li>If the value <code>none</code> is used, no image is rendered.
	<li>If the value <code>empty</code> is used, an empty image is
	    rendered.
	<li>If the value <code>alt:&lt;method&gt;?&lt;url&gt;</code> is used,
	    don't use the website's icon (which may be inaccessible due to
	    referer restrictions), but use the specified alternative method.
	    Current methods are:
	    <ul>
              <li><code>google</code>: Use Google's database.
	      <li><code>*</code>, <code>any</code>: Use any of the known
		  methods. This is the default if <code>:&lt;method&gt;</code>
		  is not specified.
	    </ul>
	    If <code>?&lt;url&gt;</code> is specified, that URL is used,
	    otherwise the target URL is used as a base for the alternative
	    method.
	<li>If the value <code>char:&lt;x&gt;</code> is used, the (short) text
	    after the colon is used to create an icon.
	<li>If the value <code>html:&lt;x&gt;</code> is used, the (short) text
	    after the colon is used to create a &lt;div&gt;. The contents is
	    scaled to a square.  Specifically, this can be used to display
	    unicode as in <code>html:&amp;#x2661;</code> (white heart,
	    &#x2661;).
      </ul>
  <li><dt>Checkbox</dt>: If <code>[ ]</code> or <code>[x]</code> is at the
      start of a line, render a checkbox for this item, so it can be used as a
      todo list item.
  <li><dt>url=URL</dt>: Target of this link. If this exists, no URL is
      attempted to be recognized in the rest of the line. So this is also a way
      to override the URL (possibly to empty) if a URL occurs in the Name too.
  <li><dt>target=target</dt>: Open the URL in the defined target. Typical values are:
      <ul>
        <li><code>absent</code>: Use same window (default)
        <li><code>_blank</code>: Use a new window or tab.
	<li><code>manual</code>: Display text to instruct the user to paste the
	    user to manually paste the URL in the address bar.
      </ul>	
</ul>
If both Name and URL are not defined, the word <code>LINK</code> is used.
The elements may be specified in any order on the line.
</p>


<h4>Example Links</h4>

<P>
Below is an example of lines specifying a Link.
<pre>
  Example                              : Just a string 'Example' without link
  http://example.com                   : Link with name http://example.com and icon http://example.com/favicon.ico
  Example http://example.com           : Same link with name 'Example'
  Example icon=none http://example.com : Same link, but no Icon
  Example:3 url=                       : Show 'Example:3' without link (although Name matches a URL)
  Submenu http://example.com           : Item 'Submenu' that is a link and has sub-Items.
    ...
  Submenu                              : Submenu without link
    ...
  http://example.com                   : Submenu with link that is used as name too
    ...
</pre>
</p>


<a name="search-functions"></a>
<h2>New Search Function</h2>

<p>
The line <code>!search identifier | label | tooltip | icon</code> defines a
search button to be displayed next to the search box. The fields are separated
by <code>|</code> with whitespace allowed.  These are the fields to be
specified:
<ul>
<li><dt>Identifier</dt> (mandatory): Unique name for this button definition.
<li><dt>Label</dt> (default: <i>Identifier</i>): This is the text to be
    displayed next to the icon on the button.
<li><dt>Tooltip</dt> (default: <i>Identifier</i>): This is the text to be
    displayd if the mouse is hovered over the button.
<li><dt>Icon</dt> (default: <code>default</code> if SearchFunction exists,
    <code>char:U+1F50D</code> (magnifying glass, &#x1F50D;) if not): This is
    the specification of the icon to display. See the icon=URL of Links for the
    syntax.
</ul>
</p>

<p>
The following properties are derived:
<ul>
<li><dt>Search URL Function</dt>:
    Function to call to retrieve the URL to go to for the results if
    the search query does not look like a domain.
    Input of this function is the contents of the SearchBox.
    This function is found by looking up the Identifier in
    SearchFunctions and then the 'text' sub-function.
    If no SearchFunction can be found, use the one with
    Identifier='default'.
<li><dt>Domain Search URL Function</dt>:
    Function to call to retrieve the URL to go to for the results if
    the search query does look like a domain.
    Input of this function is the contents of the SearchBox.
    This function is found by looking up the Identifier in
    SearchFunctions and then the 'domain' sub-function.
    If no SearchFunction can be found, use the one with
    Identifier='default'.
</ul>
</p>

<p>
Pre-defined Identifiers (case-insensitive) are:
<ul>
<li><code>Duck</code>: Use Duck Duck Go for text
<li><code>Google</code>: Use Google Search for text
<li><code>Wikipedia</code>: Use Wikipedia for text
<li><code>YouTube</code>: Use YouTube for text
<li><code>Wayback</code>: Use Wayback Machine Internet Arcive for both text and
    domains.
<li><code>GoogleMaps</code>: Use Google Maps for text
<li><code>default</code>: Text search returns null to ignore the search.
    Domain search returns the input as URL to bypass a results page.
</ul>
</p>

<p>
In JavaScript, <code>SearchFunction</code> can be extended with additional
functions that can be used for new buttons. The field name in SearchFunction
must be all lowercase. The function should have a single argument that is
the string to search for. The function should return a URL to go to for the
search results.
<br>
The function <code>getTemplateUrl</code> can be used to generate such a
function, based on a template of the URL.
<br>
Note that this function is also used to try and find a
<code>favicon.ico</code>.
</p>

<p>
The <code>SearchFunction</code> has the following sub-keys:
<ul>
<li><code>'domain'</code>: This function is called when the search text
    resembles a domain name.
<li><code>'text'</code>: This function is called to search other text.
</ul>
</p>

<p>
Example on how to create a search button for Amazon:
<pre>
!search Amazon
!script
SearchFunction['amazon'] = { 'text': getTemplateUrl('https://www.amazon.com/s?k=%urlinput') };
!endscript
</pre>
</p>

<p>
Silly example for a Random button:
<pre>
!search Random ||| html:&amp;#x2753;
!script
SearchFunction['xkcd'] = { 'text': () =&gt; 'https://c.xkcd.com/random/comic/' };
SearchFunction['random'] = {
    'text': input =&gt; {
        let options = [ 'google', 'duck', 'wikipedia', 'amazon', 'xkcd' ];
        let r = Math.trunc(Math.random() * options.length);
        return SearchFunction[options[r]]['text'](input);
    }
};
!endscript
</pre>
</p>


<a name="themes"></a>
<h2>Themes</h2>

<p>
Themes are implemented in a very simple way. The colors that are used are
defined as CSS variables in a *-theme CSS class. Currently there is a
<code>dark-theme</code> and and a <code>light-theme</code>.
<br>
The theme can be changed by using <code>!theme name</code> where name is the
CSS class name of the theme or <code>auto</code> (the default)  in which case
the browser preference setting is used.
</p>

<p>
The current variables are:
<ul>
<li><dt>--foreground</dt>,
    <dt>--background</dt>:
    Default foreground and background colors.
<li><dt>--accent-color</dt>:
    Color for titles, labels and icons.
<li><dt>--block-foreground</dt>,
    <dt>--block-background</dt>,
    <dt>--block-border</dt>:
    Foreground, background and border colors for Block level items.
<li><dt>--selection-foreground</dt>,
    <dt>--selection-background</dt>:
    Foreground and background color for selected text.
<li><dt>--code-foreground</dt>,
    <dt>--code-background</dt>:
    Foreground and background color for <code>&lt;code&gt;</code> and
    <code>&lt;pre&gt;</code> fragments.
<li><dt>--link-color</dt>: 
    Foreground color of hyperlinks.
<li><dt>--disabled-color</dt>:
    Foreground color for disabled items.
<li><dt>--error-foreground</dt>,
    <dt>--error-background</dt>,
    <dt>--error-border</dt>:
    Foreground, background and border color for search box in case of
    unrecognized input.
</ul>
</p>

<p>
A theme can be modified like this:
<pre>
!style
.dark-theme {
    --accent-color: #CC6600;
} 
!endstyle
</pre>
</p>

</body>

</html>

<!-- vim: set fdm=marker: -->

