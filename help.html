<!DOCTYPE html>
<html>

<head>

<!-- This page may contain UTF-8 encoded text. -->
<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">

<title>Favorites and ToDo - Help</title>

<style>
/* CSS styles {{{ */

/****************************************************************************
 * Global definitions
 ****************************************************************************/

@media (prefers-color-scheme: dark) {
/* Color palette - dark theme */
.normal-theme, .dark-theme {
	--foreground: #DDDDDD;
	--background: #181818;
	--accent-color: #50A0EE;
	--block-foreground: #000000;
	--block-background: #C9CDD0;
	--block-border: #EEEEEE;
	--selection-foreground: #000000;
	--selection-background: #DDDDFF;
	--code-foreground: #FFFFFF;
	--code-background: #292D36;
	--link-color: #6666FF;
	--disabled-color: #888888;
	--error-foreground: #FF6600;
	--error-background: #FFD8C0;
	--error-border: var(--error-foreground);
}
}

@media (prefers-color-scheme: light) {
/* Color palette - light theme */
.normal-theme, .light-theme {
	--foreground: #444444;
	--background: #E8F0F8;
	--accent-color: #4444EE;
	--block-foreground: #222222;
	--block-background: #D9DDE0;
	--block-border: #999999;
	--selection-foreground: #FFFFFF;
	--selection-background: #000099;
	--code-foreground: #000000;
	--code-background: #E3EBF3;
	--link-color: #2222AA;
	--disabled-color: #888888;
	--error-foreground: #FF8844;
	--error-background: #FFEEDD;
	--error-border: #FFBB88;
}
}

:root {
	/* Define variables that will be used on visible elements */
	--font-family: 'Segoe UI', 'Lucida Grande', Helvetica, sans-serif;
	--font-size: 100%;
	/* Set default font and size */
	font-family: var(--font-family);
	font-size: 12pt;  /* absolute, so --font-size can be relative too */
}

body, input, textarea, button {
	font-family: var(--font-family);
	font-size: var(--font-size);
}

body {
	color: var(--accent-color); background: var(--background);
}
::selection {
	color: var(--selection-foreground); background: var(--selection-background);
}


/****************************************************************************
 * Shared styles for displaying text-blocks
 * These syles are shared between all pages
 ****************************************************************************/

.text-block {
	color: var(--foreground); background: var(--background);
}
.text-block h1, .text-block h2, .text-block h3, .text-block em {
	color: var(--accent-color);
}
.text-block code, .text-block pre {
	color: var(--code-foreground); background: var(--code-background);
}
.text-block code {
	padding: 0.1em 0.4em;
}
.text-block pre {
	padding: 0.6em 1em;
	margin: 0.5em 4em;
	overflow: scroll;
}
.text-block em {
	font-style: normal;
}
.text-block a {
	color: var(--link-color);
	text-decoration: none;
}
.text-block a:hover {
	text-decoration: underline;
}
.text-block .important {
	color: var(--error-foreground);
}

.svg-icon {
	vertical-align: middle;
	display: inline;
	margin: -0.5em 0em -0.5em 0em;
	& path {
		stroke: var(--foreground);  fill: var(--foreground);
	}
}

/* }}} */
</style>

</head>

<body class="text-block normal-theme">


<h1>Favorites and ToDo - Help</h1>


<!-- The following section is also included as a text block in
DefaultLinks in favorites.html -->

<a name="description"></a>
<h2>Description</h2>

<p>
<a href="favorites.html">favorites.html</a> is a single page that can be
configured to show <u>links</u> and <u>todo lists</u>, organized in
<u>sections</u>, <u>blocks</u> and <u>items</u>. This configuration can be
downloaded via a URL and/or edited in the browser's local storage (see below).
<br>
This page can be set as home page in the browser's settings and as the Tab
start page via an add-on like <a
href="https://addons.mozilla.org/en-US/firefox/addon/new-tab-override/">New Tab
Override</a>.
</p>

<p>
Note that the home page can be a local file (with <code>file:///...</code>
URL) or an internet address (with <code>http://...</code> or
<code>https://...</code> URL) and that the tab start page can only be an
internet address.
</p>


<a name="usage"></a>
<h2>Usage</h2>

<p>
The standard usage is to open the page favorites.html (or possibly set it as
your home page). Upon first opening, it shows a default example page.  This
page can be edited by going to the Settings (gears (&#x2699;) icon) and just
edit and save the textual configuration. Optionally, this configuration can be
maintained in a separate text file and copy-pasted into the Settings.
<br>
Since GitHub provides for a way to serve HTML pages directly, this can be used
to open and use favorites.html directly from <a
href="https://html-preview.github.io/?url=https://github.com/anne-gert/favorite-links/master/favorites.html">GitHub</a>.
Save the target of this link to your home page and you're set.
</p>

<p>
<em>Tip</em>: By adding the <code>?links=&lt;config-name&gt;</code> in the URL,
multiple independent configurations can be defined, each having their own URL.
Each configuration has its own <i>load-options</i> and <i>save-options</i>
under Settings, but if those are left blank, the configuration is only stored
locally (see <a href="external-files.html">Read/write online configuration</a>
for details).
</p>

<p>
<em>Tip</em>: For longer configurations, scrolling to the right place in
Settings may be cumbersome. To make this easier, it is also possible to double
click on the space after an item, which opens Settings with the text cursor at
the line of that item.
</p>


<h3>Easy</h3>

<p>
The easiest method to get started is to copy the contents of the
example-links.txt file into the Settings text panel and start editing that.
<br>
The vast majority of the lines will simply consist of indentation, name and
URL. Add a few <code>!search</code> options and that's it.
</p>

<p>
Many more things are possible, but you DON'T NEED to and can stop reading here.
If you want to, though, please continue reading any of these topics:
<ul>
<li><a href="external-files.html">Read/write online configuration</a>
<li><a href="#syntax">Configuration</a>
    <ul>
    <li><a href="#line-syntax">How to configure different options?</a>
    <li><a href="#link-syntax">Link syntax</a>
    <li><a href="#link-examples">Link examples</a>
    </ul>
<li><a href="#icons">Icons</a>
<li><a href="#checkboxes">Checkboxes</a>
<li><a href="#search-functions">Adding new search methods</a>
<li><a href="#themes">Theming</a>
</ul>
</p>

<hr>


<a name="syntax"></a>
<h2>Configuration Syntax</h2>

<p>
The configuration consists primarily of a list of <a
href="help.html#link-syntax">Link Definitions</a>.  The Links form an
hierarchical structure, indicated by the line's indentation:
<ul>
<li><em>Section</em>: The first indentation level is the Section. Sections are
    separated by horizontal lines.
<li><em>Block</em>: The second indentation level are the blocks within a
    Section. Each Block is a visual area that can be collapsed and expanded.
<li><em>Item</em>: The third indentation level are the Items that populate
    the Blocks.
<li><em>SubItem</em>: The fourth and higher indentation levels are SubItems
    that are displayed under their respective parent Items
</ul>
Each link can be a hyperlink, have an icon and/or a checkbox.
</p>

<p>
In addition to Links, the configuration also supports comments, different
web-search functions and other directives, see <a
href="help.html#line-syntax">Line Syntax</a> for details.
</p>

<!-- End of text to be included in text block -->


<a name="line-syntax"></a>
<h3>Line Syntax</h3>

<p>
Each line should be one of the following:
<ul>
  <li><em>Empty lines</em>: These are skipped.
  <li><em>Comments</em>: Lines that start with <code>//</code>, <code>;</code>
      or <code>#</code> are comments and skipped too.
  <li><em>Folding</em>: If a line ends with <code>{{{</code> or
      <code>}}}</code>, remove that.  These tags are used to facilitate folding
      in vim.
  <li><em>Link Item</em>: Specify a Link or ToDo item. See <a
      href="#link-syntax">below</a>.
  <li><em>Separator</em>: This is a line containing a name of 3 or more dashes
      (<code>---</code>).  It is rendered as an <code>&lt;hr
      class="separator"&gt;</code>.
  <li><em>Page Title</em>: The line <code>!title name</code> specifies the page
      title to be displayed.
  <li><em>Theme</em>: The line <code>!theme name</code> specifies the CSS class
      name to use for the theme. Currently 'auto' (default), 'dark-theme' and
      'light-theme' are defined, but custom themes can be defined with a Style
      Block. See <a href="#themes">below</a> on use cases.
  <li><em>Font Size</em>: The line <code>!size font-size</code> specifies the
      base font-size to use. All CSS length quantities can be used, e.g.
      '10pt' or '120%'. This feature is experimental.
  <li><em>Blocks Collapsed</em>: The line <code>!collapsed state</code>
      specifies how blocks are displayed when loaded:
      <ul>
      <li><em>no</em> (default): Blocks are expanded if not previously closed.
      <li><em>yes</em>: Blocks are closed if not previously expanded.
      <li><em>always</em>: Blocks are always closed (previous state is
          ignored).
      <li><em>never</em>: Blocks are always expanded (previous state is
          ignored).
      </ul>
  <li><em>Search Buttons</em>: The line <code>!search identifier | label |
      tooltip | icon | url-template</code> defines a search button to be
      displayed next to the search box.  See <a
      href="#search-functions">below</a> for more details.
  <li><em>Icon Definitions</em>: The line <code>!icon name replacement</code>
      defines an icon. If a link uses <code>icon=name</code>, it will be
      replaced by whatever is defined for name.  This also works with the
      special words <code>none</code>, <code>empty</code>, <code>html:x</code>,
      etc.  It is also allowed to write this with an <code>=</code> between
      name and replacement. See <a href="#icons">Icons</a> for more on icons.
  <li><em>Checkbox Definition</em>: The line <code>!checkbox name options
      ...</code> defines a custom checkbox. See <a
      href="#checkboxes">Checkboxes</a> for more details.
  <li><em>Text Block</em>: A text block is the lines of text between
      <code>!text</code> and <code>!endtext</code>, which each should appear
      on a line of their own. The text block will be rendered at that
      location. It can contain any HTML
  <li><em>Style Block</em>: A style block is the lines of text between
      <code>!style</code> and <code>!endstyle</code>, which should contain CSS
      definitions. See <a href="#themes">Themes</a> for an example.
  <li><em>Script Block</em>: A script block is the lines of text between
      <code>!script</code> and <code>!endscript</code>, which should contain
      JavaScript code that is executed at the beginning of the page. See <a
      href="#search-functions">Search Functions</a> for an example.
  <li><em>Automatic Upload Delay</em>: Some events (like changing a checkbox
      value) triggers an upload if <a
      href="external-files.html#save-options">Online Save</a> has been set.
      To avoid many updates in quick succession, an upload delay can be set
      with <code>!auto-upload-delay value</code>, where value is a delay in
      seconds. Default is 3 seconds.
  <li><em>Disable Edits</em>: The line <code>!no-edit</code> makes the
      configuration text in Settings unmodifiable.
</ul>
</p>

<p>
<span class="important">Known Issue</span>: Once a !script block is added, it
can only be reset by completely reloading the page. Just commenting out the
script in the settings and saving will not unload the previous script, which is
still present in memory.
</p>

<p>
As an example, add the following to the settings:
<pre>
!script
let hue = 0;
const step = 5;
const interval = 50;
window.setInterval(() =&gt; document.body.style.backgroundColor = 'hsl(' + (hue += step) + 'deg, 100%, 20%)', interval);
!endscript
</pre>
This will set a timer handler that continuously changes the background color.
<br>
Now open the settings and make the following change:
<pre>
const interval = 60;
</pre>
When this is saved, the background starts to blink erraticly. After reloading
the page, it starts changing the color normally again.
<br>
The reason is that after saving the change, a <b>second</b> timer handler was
set and both timers interferred. The reload discards both timers and set a new
one in a clean page.
</p>


<a name="link-syntax"></a>
<h3>Link Syntax</h3>

<p>
Each Link is specified on a single line as follows:
<ul>
  <li><em>Indentation</em>: The amount of indentation determines the nesting
      depth:
      <ul>
        <li>Tabs are replace by 8 spaces.
	<li>If the number of spaces is bigger than that of the previous line,
	    increase nesting depth by 1.
	<li>If the number of spaces is less than that of the previous line,
	    decrease the nesting depth to that of the most recent line that has
	    an indentation that is strictly less than this line.
      </ul>
  <li><em>&amp;</em> continuation: If the item starts with <code>&amp;</code>,
      this item is regarded as a continuation of a group of items that are
      displayed on a single line.
  <li><em>Name</em>: Arbitrary string of characters.
      <ul>
        <li>If no name is given, the URL is used.
	<li>If the name is <code>_</code> and any of the following conditions
	    is met, no name is displayed. The conditions are:
	    <ul>
	      <li>An icon is present.
	      <li>It is not clickable, i.e. there is no URL.
	    </ul>
	    If none of these conditions are met, the <code>_</code> is
	    replaced by 'Heading', 'Block' or 'Item', depending on the
	    indentation level.
	<li>Regions in <code>*...*</code> are displayed in bold. Multiple '*'
	    characters are allowed, but the begin and end should match.
      </ul>
  <li><em>URL</em>: A string of non-whitespace characters, beginning with
      <code>scheme:</code>.
      <ul>
        <li>If no URL is given, no hyperlink is created.
	<li>If the URL is <code>search:identifier</code>, a search link is used
	    that uses the text search function with that identifier (as
	    described in <a href="#search-functions">Search Functions</a>) to
	    search for this Link's Name. Note that the identifier is
	    case-insensitive and spaces should be replaced by '_'.
      </ul>
  <li><em>icon=value</em>: Defines the icon to use. See <a
      href="#icons">Icons</a> for how to define the value.
  <li><em>Checkbox</em>: If <code>[ ]</code> or <code>[x]</code> is at the
      start of a line, render a standard checkbox for this item, so it can be
      used as a todo list item. Custom checkboxes with icons can also be used
      by specifying <code>[]:name</code> where <i>name</i> is the name of a
      <code>!checkbox</code> definition, see <a
      href="#checkboxes">Checkboxes</a> for more details.
  <li><em>url=URL</em>: Target of this link. If this exists, no URL is
      attempted to be recognized in the rest of the line. So this is also a way
      to override the URL (possibly to empty) if a URL occurs in the Name too.
  <li><em>target=target</em>: Open the URL in the defined target. Typical values are:
      <ul>
        <li><code>absent</code>: Use same window (default)
        <li><code>_blank</code>: Use a new window or tab.
	<li><code>manual</code>: Display text to instruct the user to paste the
	    user to manually paste the URL in the address bar.
      </ul>
  <li><em>css=class-name</em>: Add the specified CSS class to this item. This
      class can be used to select this item and its children.
</ul>
The elements may be specified in any order on the line.
</p>


<a name="link-examples"></a>
<h4>Example Links</h4>

<p>
Below is an example of lines specifying a Link.
</p>

<p>
Different combinations of links and names.
<pre>
  Example                              : Just a string 'Example' without link
  http://example.com                   : Link with name http://example.com and icon http://example.com/favicon.ico
  Example http://example.com           : Same link with name 'Example'
  Example icon=none http://example.com : Same link, but no Icon
  Example:3                            : Show 'Example:3', linking to the URL Example:3, because it also matches schema:location
  Example:3 url=                       : Show 'Example:3' without link
  Rare word search:Google              : Show 'Rare word' with link that searches 'Rare word' on Google
</pre>
Submenus and indentation levels.
<pre>
  Submenu http://example.com           : Item 'Submenu' that is a link and has sub-Items.
    ...
  Submenu                              : Submenu without link
    ...
  http://example.com                   : Submenu with link that is used as name too
    ...
</pre>
Hidden names.
<pre>
  _                                    : Will not be displayed
  _ http://example.com                 : Will display a clickable icon
  _ icon=none http://example.com       : Will display 'Heading' that is clickable
    _ icon=empty http://example.com    : Will display 'Block' that is clickable
      _ icon=empty http://example.com  : Will display 'Item' that is clickable
</pre>
Checkboxes.
<pre>
  [ ]                                  : Displays a checkbox without label
  [] _                                 : Same thing
  [x] http://example.com               : Display checkbox with link
</pre>
Specifying icons.
<pre>
  !icon www.example.com https://static.example.com/assets/icon1.png
  !icon icon2 https://static.example.com/assets/icon2.png
  !icon iconToo icon2
  http://example.com                   : Uses icon http://example.com/favicon.ico (default)
  http://www.example.com               : Uses icon icon1.png from !icon above (implicit)
  icon=icon2 http://www.example.com    : Uses icon icon2.png from !icon above (explicit)
  icon=iconToo http://www.example.com  : Uses icon icon2.png from !icon above (expliciti, recursive)
  icon=alt http://example.com          : Use alternate
  icon=alt:google http://example.com   : Use alternate from Google
  icon=html:&lt;span&amp;space;style="color:green"&gt;&amp;#x2714;&lt;/span&gt; http://example.com
</pre>
</p>


<a name="icons"></a>
<h2>Icons</h2>

<p>
At different places, icons can be used. An icon can be any of the following
values:
<ul>
<li>URL: This URL is used as the image URL of the icon.
<li><code>default</code>: If value is default or no icon is given, the URL
    domain + <code>favicon.ico</code> is used. If the URL domain is the name of
    an !icon definition, that value is used.
<li><code>none</code>: No image is rendered.
<li><code>empty</code>: An empty image is rendered.
<li><code>alt:&lt;method&gt;?&lt;url&gt;</code>: Instead of the website's icon
    (which may be inaccessible due to referer restrictions), use the specified
    alternative method. Current methods are:
    <ul>
      <li><code>google</code>: Use Google's database.
      <li><code>*</code>, <code>any</code>: Use any of the known methods. This
          is the default if <code>:&lt;method&gt;</code> is not specified.
    </ul>
    If <code>?&lt;url&gt;</code> is specified, that URL is used, otherwise the
    target URL is used as a base for the alternative method.
<li><code>char:&lt;x&gt;</code>: Use the (unicode) character or (short) text
    after the colon to create an icon. To use, a Unicode character, it can be
    entered in either UTF-8 encoding or as U+xxxxx for the codepoint with
    hexadecimal number xxxxx, e.g.  <code>char:U+2661</code> (white heart,
    &#x2661;).
<li><code>html:&lt;fragment&gt;</code>: Use the specified HTML fragment after
    the colon to create a &lt;div&gt;. The contents is scaled to a square. To
    include a space in the fragment use &amp;space; (or the shorthand &amp;sp;
    or &amp;spc;).
<li><code>krul</code>: A 'Krul' is a Dutch symbol that is similar to a
    checkmark and means "good" or "done". See also <a
    href="https://nl.wikipedia.org/wiki/Goedkeuringskrul">Wikipedia</a>.
</ul>
</p>

<p>
It is allowed to redefine an icon, but only the last definition will be used.
</p>

<h4>Undefined Icons</h4>

<p>
If an icon definition is used that is not defined, the special
<code>undefided</code> icon will be shown. This definition can be redefined.
<pre>
icon=unknown Not Defined     : shows <em>!ND!</em> ('not defined')
</pre>
<pre>
icon=unknown Not Defined     : shows <em>?</em>

!icon undefined char:?       : define undefined as '?'
</pre>
</p>

<h4>Reference Loops</h4>

<p>
Since an icon definition can refer to another, it would be possible to create
a reference loop. If such an icon is used, the special <code>refloop</code>
icon will be shown. This definition can be redefined.
<pre>
!icon icon2 icon1
!icon icon1 icon2            : icon1 and icon2 are now in a reference loop

icon=icon1 Reference Loop    : shows <em>!ND!</em> ('not defined')
</pre>
<pre>
icon=icon1 Reference Loop    : shows <em>&#x221E;</em>

!icon refloop char:U+221E    : define refloop as &#x221E;
</pre>
</p>


<a name="checkboxes"></a>
<h2>Checkboxes</h2>

<p>
Standard checkboxes can be defined in an <a
href="https://www.markdownguide.org/extended-syntax/#task-lists">Extended
Markdown</a> way:
<pre>
- [ ] Unchecked value
- [x] Checked value
[x] List character is not mandatory
</pre>
The state of the checkbox is stored in the configuration and is updated when
that is enabled.
</p>


<h3>Custom Checkboxes</h3>

<p>
In addition to standard Checkboxes, <code>!checkbox name options ...</code> can
be used to define a checkbox type with custom options.  A checkbox using the
definition <em>name</em> can be specified by appending that name to the
checkbox, like so: <code>[ ]:name</code>. There should be no spaces between the
checkbox and the name.<br>
There is a special syntax where the name is left empty: <code>[ ]:</code>, in
which case, the last defined checkbox definition is used.<br>
The <em>options</em> can be single letters (or small text), icons,
pre-defined icons, the options of another definition or flags. Each of these
will be explained below. Some examples will be provided later too.
</p>

<p>
<em>Single Letter</em>
</p>

<p>
Instead of <code>[x]</code> and <code>[ ]</code>, use these letters as checkbox
values. The following notations are supported:
<ul>
<li><em>Normal character</em>: Like 'A', '4', '+', etc.
<li><em>Underscore (_)</em>: Special character interpreted as a space.
<li><em>Unicode character</em>: Literal Unicode characters, like '&#x2611;' or
    '&#x1F44D;'.
<li><em>Unicode codepoint</em>: Unicode codepoint notation, like 'U+2611' or
    'U+1F44D'.
</ul>
Note: This only works for single characters. For multiple characters, the
syntax for an icon should be used: <code>char:ABC</code>.
</p>

<p>
<em>Icon</em>
</p>

<p>
Everything that can be used for <em>icons</em>, can also be used as an option
for a checkbox, like image URLs, char:&lt;x&gt;, html:&lt;fragment&gt;, see <a
href="#icons">Icons</a> for more details and <a href="line-syntax">Line
Syntax</a> for the <code>!icon</code> syntax. This allows the use of URLs to
images, HTML fragments, pieces of text, etc. One thing to keep in mind, though,
is that the currently selected value is also stored in the configuration inside
[...]. To keep this short, it is advisable to define a short text token in the
option: <code>[x]icon</code>. Here, the token <code>[x]</code> will be
displayed as the <code>icon</code>. The token can be a single letter of short
text.<br>
If no token is explicitly specified, the icon value is used as token, therefore
<code>[X]X</code> and <code>X</code> are equivalent.
</p>

<p>
<em>Special Shorthand Icon</em>
</p>

<p>
For convenience some pre-defined options are available:
<ul>
<li><em>empty</em>: Shorthand for <code>[_]empty</code>.
<li><em>uncheck</em>: Shorthand for <code>[_]U+2610</code> (empty box, &#x2610;).
<li><em>check</em>: Shorthand for <code>U+2611</code> (checked box, &#x2611;).
<li><em>cross</em>: Shorthand for <code>U+2612</code> (crossed box, &#x2612;).
<li><em>mcheck</em>: Shorthand for <code>U+25A3</code> (filled box, &#x25A3;).
<li><em>krul</em>: Shorthand for <code>[g]krul</code> (Dutch 'krul' icon,
    <div class="svg-icon">
        <svg width="1.4em" height="1.4em" xmlns="http://www.w3.org/2000/svg">
            <path d="M9.7,-0.6C8.1,-0.5 7,.8 6,1.8 4.8,3.2 3.6,4.6 3.2,6.3 2.7,7.6 3.7,8.9 4.1,9.7 2.5,11.2.9,12.7-0.7,14.3c-0.6,1.3 1.3,1.9 1.9,.7 1.6,-1.6 3.2,-3.1 4.8,-4.7 1.3,.2 3.4,1.3 2.1,2.8-1,2-2.1,3.9-2.9,5.9-0.7,1.6.8,3.5 2.5,3 1.8,-0.6 3.4,-1.7 5,-2.8C21.8,12.6 25.2,5.9 24,6.7 19.5,11.8 14.3,16.5 8.3,19.8c-1,.9-1.9,.2-1,-0.9 1,-2 2.1,-3.9 2.9,-5.9.5,-1.4-0.2,-2.9-1.5,-3.6-0.7,-0.4-1.7,-0.5-0.6,-1.2 1.5,-1.6 3,-3.1 4.2,-4.9.9,-1.4-0.1,-3.4-1.6,-3.9-0.3,-0.1-0.7,-0.2-1,-0.2zm.1,1.9c1.5,.1.9,1.7.1,2.3C8.5,5.2 7.1,6.7 5.5,8.2 4.2,7.3 5.4,5.7 6,4.7 7,3.4 8.1,2.1 9.5,1.3l.2,-0z"/>
        </svg>
    </div>).
</ul>
The representation of these pre-defined icons can be changed. E.g. to use a
different icon for the checkmark, use <code>!icon check
http://example.com/icon.png</code>.
</p>

<p>
<em>Another Checkbox</em>
</p>

<p>
If the name of an other checkbox definition is used as an option, all its
options are included. Checkboxes referring to each other in a circular
dependency (called a <i>reference loop</i>) is not allowed.
</p>

<p>
<em>Flags</em>
</p>

<p>
There are also a number of flags that influence how the checkbox is used:
<ul>
<li><em>!front</em>, <em>!before</em>: Places the checkbox in front of the item
    text.
<li><em>!back</em>, <em>!after</em>: Places the checkbox after the item text.
<li><em>!debug</em>: Display the interpreted !checkbox definition at the point
    of definition, so the interpretation can be inspected for debugging
    purposes.
</ul>
</p>

<p>
The full syntax of a checkbox option is <code>identifier=[token]value</code>.
The mandatory <em>value</em> and optional <em>token</em> have already been
described above. The <em>identifier</em> is also optional and should only
contain letters, numbers or '_'. The identifier is used to find the correct CSS
class for an option (see example below).
</p>

<p>
Example 1: Simple checkbox with standard Unicode icons:
<pre>
!checkbox standard [_]uncheck [x]check
[ ]:standard Option 1
[x]:standard Option 2
</pre>
</p>

<p>
Using the special shorthand syntax to refer to the last defined type, this is
the same as:
<pre>
!checkbox standard [_]uncheck [x]check
[ ]: Option 1
[x]: Option 2
</pre>
</p>

<p>
Example 2: Standard checkbox with sub-options:
<pre>
!checkbox sub uncheck check mcheck
[ ]:sub Option 1
[&#x25A3;]:sub Option 2
    [&#x2611;]:sub Option 2-1
    [ ]:sub Option 2-2
</pre>
</p>

<p>
Example 3: Checkbox with 3 values, A, B and C:
<pre>
!checkbox letters A B C
[A]:letters Option 1
[B]:letters Option 2
[C]:letters Option 3
</pre>
</p>

<p>
Example 4: Checkbox with 3 values, I, II and III:
<pre>
!checkbox roman I char:II char:III
[I]:roman Option 1
[II]:roman Option 2
[III]:roman Option 3
</pre>
</p>

<p>
Example 5: Checkbox with 3 values, unknown (&#x2753;), thumbs-up (&#x1F44D;)
and thumbs-down (&#x1F44E;):
<pre>
!checkbox yesno [_]U+2753 [yes]U+1F44D [no]U+1F44E
[ ]:yesno Option 1
[yes]:yesno Option 2
[no]:yesno Option 3
</pre>
</p>

<p>
Example 6: It is also possible to copy the unicode characters directly into
the definition. E.g. from <a href="https://www.unicode.org/emoji/charts/full-emoji-list.html">Full Emoji List, v16.0</a>,
copy the icon in the 'Sample' column for characters U+1F641, U+1F610 and
U+1F642:
<pre>
!checkbox emo üôÅ üòê üôÇ
[&#x1F641;]:emo Option 1
[&#x1F610;]:emo Option 2
[&#x1F642;]:emo Option 3
</pre>
</p>

<p>
Example 7: Checkbox with 7 values, empty, check and 5 icons where '1' and '3'
show the same icon because of the !icon and '2' and '5' also show the same icon
because both options have the same display value. The check icon (&#x2611;) is
overriden with a checkmark (&#x2714;):
<pre>
!checkbox icons empty check [1]icon1 [2]icon2 [3]icon3 [4]icon4 [5]icon2
[1]:icons Option 1
[2]:icons Option 2
!icon icon1 http://example.com/icon1.png
!icon icon2 http://example.com/icon2.png
!icon icon3 icon1
!icon icon4 char:X
!icon check char:U+2714
</pre>
</p>

<p>
Example 8: Links to read with the URL icon in front and a checkbox after the
text. The checkbox can be empty, '+' or '-':
<pre>
!checkbox good _ + - !after
[ ]:good Item 1 http://example.com/item1
[+]:good Item 2 http://example.com/item2
[-]:good Item 3 http://example.com/item3
</pre>
</p>


<h4>Undefined Checkbox</h4>

<p>
If a checkbox name is used that is not defined, the <code>default</code>
checkbox will be used:
<pre>
[ ]:undefined Not defined                   : shows normal checkbox
</pre>
This <code>default</code> may be overridden, see below.
</p>


<h4>Overriding Default Checkbox</h4>

<p>
If no checkbox definition is supplied, the default checkbox definition is used.
If that is not defined, the standard checkboxes are used. By defining a default
checkbox definition, the behevior of all default checkboxes can be changed. As
an example, the example below make all checkboxes have 3 states: &#x2753;
(U+2753), a green <span style="color:green">&#x2714;</span> (U+2714) and a red
&#x274C; (U+274C).
<pre>
!checkbox default [_]U+2753 [x]html:&lt;span&amp;sp;style="color:green"&gt;&amp;#x2714;&lt;/span&gt; [-]U+274C
[ ] Unknown
[x] Yes
[-] No
</pre>
</p>


<h4>Re-defined Checkbox</h4>

<p>
If a Custom Checkbox is defined multiple times, The most recent definition is
used. If there is no definition yet, the very last definition is used.
<pre>
[ ]:levels Use last definition              : shows A/B/C
!checkbox levels 1 2 3
!checkbox levels X Y Z
[ ]:levels Use most recent definition       : shows X/Y/Z
!checkbox levels A B C
</pre>
</p>

<p>
The default checkbox can be reset by re-defining <code>default</code> without
any options:
<pre>
[ ] Option                                  : shows standard checkbox
!checkbox default A B C
[ ] Option                                  : shows A/B/C
!checkbox default
[ ] Option                                  : shows standard checkbox again
!checkbox default !back
[ ] Option                                  : shows standard checkbox at the back
</pre>
</p>


<h4>Extended Checkbox</h4>

<p>
If a checkbox definition name is used as one of the options of another
checkbox definition, the options of the former are included in the latter.
This way, the latter can be extended.
<pre>
!checkbox letters A B C
!checkbox numbers 1 2 3
!checkbox choices letters numbers X Y Z
[ ]:choices Make your choice                : shows A/B/C/1/2/3/X/Y/Z in front
!checkbox choices-after choices !after
[ ]:choices-after Make your choice          : shows A/B/C/1/2/3/X/Y/Z after
</pre>
</p>


<h4>Reference Loops</h4>

<p>
If a reference loop is created when extending a checkbox, all definitions that
depend on the loop will be shows as the special <code>refloop</code> value.
<pre>
!checkbox options1 A B C
!checkbox options2 1 2 3 options1 options3
!checkbox options3 X Y Z options2
!checkbox options4 h j k l options2
[ ]:options1 This is fine                   : shows A/B/C
[ ]:options2 Reference Loop                 : shows <em>!RL!</em>
[ ]:options3 Reference Loop                 : shows <em>!RL!</em>
[ ]:options4 Depends on Reference Loop      : shows <em>!RL!</em>
</pre>
</p>


<h4>CSS Styles for Checkboxes</h4>

<p>
By using checkbox option identifiers, each option can be given a CSS style
class. The easiest method is to use explicit identifiers like in the following
example:
<pre>
!checkbox colors red=R green=G blue=B

!style
.cbx-opt-red { background: #F88 }
.cbx-opt-green { background: #8F8 }
.cbx-opt-blue { background: #88F }
!endstyle

[R]:colors A color
[G]:colors A color
[B]:colors A color
</pre>
<span class="important">Note</span>: If no token is specifiedi (i.e. no
<code>[...]</code>), generally the shorter of identifier or value is used as
token. In this case the R/G/B values rather than the red/green/blue
identifiers.
</p>

<p>
If the identifier is explicitly specified, the used CSS class becomes
<code>cbx-opt-<i>identifier</i></code> as used above.
</p>

<p>
Specifying the identifier explicitly is more straightforward, but if you really
want to, the following section describes how to get a <em>derived
identifier</em> from the value or token, combined with the checkbox' definition
name.  To explain this, see the example below. Here the CSS style class names
are derived as follows:
<ul>
<li><code>uncheck</code>: If a <em>special shorthand icon</em> is used, that
    name is also used as an identifier. This results in the CSS class name
    <code>cbx-opt-uncheck</code>.
<li><code>[A]A</code>: If an <em>option token</em> is used, that value is added
    to the checkbox definition name and used as identifier. In this case, this
    results in a different CSS class for each checkbox
    (<code>cbx-opt-with-styles-1-A</code> and
    <code>cbx-opt-with-styles-2-A</code>), even though the option is defined
    exactly the same.
<li><code>char:B+</code>: If only an <em>option value</em> is used, the derived
    identifier is equal to all the letters, numbers and '_' and without the
    'char:' prefix. In this case, this results simply in B. Like with a token
    before, this is also combined with the checkbox definition name, resulting
    in the CSS classes <code>cbx-opt-with-styles-1-B</code> and
    <code>cbx-opt-with-styles-2-B</code>.
<li><code>C=C</code>: As already described, an explicit <em>identifier</em>
    resutls in a CSS class <code>cbx-opt-C</code>.
<li><code>$</code>: In this case, there is only an <em>option value</em>, but
    that doesn't have any letters, nummbers of '_', so no identifier can be
    derived. It would be advisable to create an explicit identifier like in
    dollar=$. But if that is not done, the <em>position index</em> can be used
    together with the checkbox definition name, resulting in the CSS classes
    for the fifth option <code>cbx-opt-with-styles-1-i5</code> and
    <code>cbx-opt-with-styles-2-i5</code>.
</ul>
Note that <em>!debug</em> can be used to display the derived identifiers.
</p>

<p>
<pre>
CSS Styles for Checkboxes
    with-styles-1
        !checkbox with-styles-1 uncheck [A]A char:B+ C=C $ !debug
        [ ]: Matched on
        [A]: Matched on
        [B+]: Matched on
        [C]: Matched on
        [$]: Matched on
    with-styles-2
        !checkbox with-styles-2 uncheck [A]A char:B+ C=C $ !debug
        [ ]: Matched on
        [A]: Matched on
        [B+]: Matched on
        [C]: Matched on
        [$]: Matched on

!style
.cbx-opt-uncheck          { background: green;  .checkbox-label::after { content: ' global \'uncheck\'' } }
.cbx-opt-with-styles-1-A  { background: yellow; .checkbox-label::after { content: ' token \'A\' for with-styles-1' } }
.cbx-opt-with-styles-2-A  { background: red;    .checkbox-label::after { content: ' token \'A\' for with-styles-2' } }
.cbx-opt-with-styles-1-B  { background: cyan;   .checkbox-label::after { content: ' \'B\', derived from value char:B+ for with-styles-1' } }
.cbx-opt-with-styles-2-B  { background: brown;  .checkbox-label::after { content: ' \'B\', derived from value char:B+ for with-styles-2' } }
.cbx-opt-C                { background: blue;   .checkbox-label::after { content: ' identifier \'C\'' } }
.cbx-opt-with-styles-1-i5 { background: purple; .checkbox-label::after { content: ' index \'i5\' for with-styles-1' } }
.cbx-opt-with-styles-2-i5 { background: pink;   .checkbox-label::after { content: ' index \'i5\' for with-styles-2' } }
!endstyle
</pre>
</p>


<a name="search-functions"></a>
<h2>Search Functions</h2>

<p>
The line <code>!search identifier | label | tooltip | icon |
url-template</code> defines a search button to be displayed next to the search
box. The fields are separated by <code>|</code> with whitespace allowed.  These
are the fields to be specified:
<ul>
<li><em>Identifier</em> (mandatory): Unique name for this button definition.
<li><em>Label</em> (default: <i>Identifier</i>): This is the text to be
    displayed next to the icon on the button. If '_' is specified, no label
    will be displayed.
<li><em>Tooltip</em> (default: <i>Identifier</i>): This is the text to be
    displayd if the mouse is hovered over the button. If '_' is specified, no
    tooltip will be displayed.
<li><em>Icon</em> (default: <code>default</code> if SearchFunction exists,
    <code>char:U+1F50D</code> (magnifying glass, &#x1F50D;) if not):
    This is the specification of the icon to display. See the <a
    href="#icons">Icons</a> for the syntax.
<li><em>URL-Template</em>: If this is defined, this string is used as the
    Search URL Function result. This template recogizes the following special
    values:
    <ul>
    <li><em>%urlinput</em>: This will be filled with the URL-encoded search
        string.
    </ul>
    If the URL-Template is not supplied, it is derived as described below.
</ul>
</p>

<p>
The following properties are derived:
<ul>
<li><em>Search URL Function</em>:
    Function to call to retrieve the URL to go to for the results if
    the search query does not look like a domain.
    Input of this function is the contents of the SearchBox.
    This function is found by looking up the Identifier in
    SearchFunctions and then the 'text' sub-function.
    If no SearchFunction can be found, use the one with
    Identifier='default'.
<li><em>Domain Search URL Function</em>:
    Function to call to retrieve the URL to go to for the results if
    the search query does look like a domain.
    Input of this function is the contents of the SearchBox.
    This function is found by looking up the Identifier in
    SearchFunctions and then the 'domain' sub-function.
    If no SearchFunction can be found, use the one with
    Identifier='default'.
</ul>
</p>

<p>
Pre-defined Identifiers are:
<ul>
<li><code>Duck Duck Go</code>: Use Duck Duck Go for text
<li><code>Google</code>: Use Google Search for text
<li><code>Wikipedia</code>: Use Wikipedia for text
<li><code>YouTube</code>: Use YouTube for text
<li><code>Wayback Machine</code>: Use Wayback Machine Internet Arcive for both
    text and domains.
<li><code>Google Maps</code>: Use Google Maps for text
<li><code>default</code>: Text search returns null to ignore the search.
    Domain search returns the input as URL to bypass a results page.
</ul>
</p>

<p>
In JavaScript, <code>SearchFunction</code> is a data structure where the keys
are derived from the Identifier with
<code>getSearchFunction(&lt;Identifier&gt;)</code> and the values contain the
search functions. This structure can be extended with additional functions that
can be used for new buttons.  The function should have a single argument that
is the string to search for. The function should return a URL to go to the
search results.
<br>
The function <code>getTemplateUrl</code> can be used to generate such a
function, based on a template of the URL.
<br>
Note that this function is also used to try and find a
<code>favicon.ico</code>.
</p>

<p>
The <code>SearchFunction</code> has the following sub-keys:
<ul>
<li><code>'domain'</code>: This function is called when the search text
    resembles a domain name.
<li><code>'text'</code>: This function is called to search other text.
</ul>
</p>

<p>
The JavaScript functions are available to create new SearchFunctions:
<ul>
<li><code>registerSearchTemplate(&lt;Identifier&gt;, &lt;URL-Template&gt;)</code>:
    This function creates a Search URL Function, based on the specified
    &lt;URL-Template&gt;. It then registers this function for the specified
    Identifier.  This function is also used when the &lt;URL-Template&gt;
    parameter of the <code>!search</code> command is used.
<li><code>registerSearchFunction(&lt;Identifier&gt;, &lt;function&gt;)</code>:
    This function registers a Search URL Function for the specified Identier.
    This function receives the search text as input and should return a URL
    as output.
<li><code>getRegisteredSearchUrl(&lt;Identifier&gt;, &lt;search-text&gt;)</code>:
    Returns the Text Search URL to search for search-text that is registered
    for Identifier.
</ul>
The following support functions are available:
<ul>
<li><code>getSearchFunctionId(&lt;Identifier&gt;)</code>: Returns the canonical
    id to be used as key in the <code>SearchFunction</code> data structure.
<li><code>getTemplateUrl(&lt;URL-Template&gt;)</code>: Returns a SearchFunction
    that uses the given URL-Template.
</ul>
</p>

<p>
Example on how to create a search button for Amazon:
<pre>
!search Amazon |||| https://www.amazon.com/s?k=%urlinput
</pre>
</p>

<p>
Search buttons can be quite flexible. For example, the current Sprint Board
on Azure DevOps  can be searched with the URL
<code>https://dev.azure.com/&lt;Organization&gt;/&lt;Project&gt;/_sprints/taskboard/&lt;Team&gt;/&lt;Project&gt;/?text=&lt;Search-Terms&gt;</code>.
Now, create a search button to search the current sprint board of MyProject for
MyTeam within MyOrganization in a few steps:
<pre>
!search MyTeam-Sprint | MyTeam | Current MyTeam Sprint | alt | https://dev.azure.com/MyOrganization/MyProject/_sprints/taskboard/MyTeam/MyProject/?text=%urlinput
</pre>
Note that https://dev.azure.com does not have a favicon that can be used.
Therefore, specify to use the alternate icon. Now the button gets the correct
icon.
</p>

<p>
Silly example for a Random button:
<pre>
!search Random |_|| html:&amp;#x2753;
!script
registerSearchTemplate(getSearchFunctionId('xkcd'), 'https://c.xkcd.com/random/comic/');
registerSearchFunction(getSearchFunctionId('Random'), input =&gt; {
    let options = [ 'Google', 'Duck Duck Go', 'Wikipedia', 'Amazon', 'xkcd' ];
    let r = Math.trunc(Math.random() * options.length);
    let id = getSearchFunctionId(options[r]);
    return getRegisteredSearchUrl(id, input);
});
!endscript
</pre>
</p>


<a name="themes"></a>
<h2>Themes</h2>

<p>
Themes are implemented in a very basic way. The colors that are used are
defined as CSS variables in a *-theme CSS class. Currently there is a
<code>dark-theme</code> and and a <code>light-theme</code>.
<br>
The theme can be changed by using <code>!theme name</code> where name is the
CSS class name of the theme or <code>auto</code> (the default)  in which case
the browser's dark/light-mode preference setting is used.
</p>

<p>
The current variables are:
<ul>
<li><em>--foreground</em>,
    <em>--background</em>:
    Default foreground and background colors.
<li><em>--accent-color</em>:
    Color for titles, labels and icons.
<li><em>--block-foreground</em>,
    <em>--block-background</em>,
    <em>--block-border</em>:
    Foreground, background and border colors for Block level items.
<li><em>--selection-foreground</em>,
    <em>--selection-background</em>:
    Foreground and background color for selected text.
<li><em>--code-foreground</em>,
    <em>--code-background</em>:
    Foreground and background color for <code>&lt;code&gt;</code> and
    <code>&lt;pre&gt;</code> fragments.
<li><em>--link-color</em>:
    Foreground color of hyperlinks.
<li><em>--disabled-color</em>:
    Foreground color for disabled items.
<li><em>--error-foreground</em>,
    <em>--error-background</em>,
    <em>--error-border</em>:
    Foreground, background and border color for search box in case of
    unrecognized input.
</ul>
</p>

<p>
A theme can be modified like this:
<pre>
!style
.dark-theme {
    --accent-color: #CC6600;
} 
!endstyle
</pre>
Or you can go wild with:
<pre>
!style
body {
    background-image: linear-gradient(120deg, red,orange,yellow,green,blue,indigo,violet,red,orange,yellow,green,blue,indigo,violet);
}
.dark-theme {
    --background: #2E323B99;
    --code-background: #28282899;
    --block-background: #C9CDD099;
}
.light-theme {
    --background: #E8F0F877;
    --code-background: #C0C0C077;
    --block-background: #D9DDE099;
}
!endstyle
</pre>
Or more rustic with:
<pre>
!style
body {
	filter: sepia(0.7);
}
!endstyle
</pre>
</p>


</body>

</html>

<!-- vim: set fdm=marker: -->

